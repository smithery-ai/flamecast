name: Flamecast

on:
  workflow_dispatch:
    inputs:
      prompt:
        description: "Prompt for Claude Code"
        required: true
        type: string
      base_branch:
        description: "Base branch for the PR"
        required: false
        type: string
        default: "main"
      target_repo:
        description: "Target repo (e.g. kamath/dotcom.chat). Leave empty for current repo."
        required: false
        type: string
      sync_base:
        description: "Merge base branch into feature branch and resolve conflicts"
        required: false
        type: boolean
        default: false

jobs:
  flamecast:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    permissions:
      contents: write
      pull-requests: write
    steps:
      - uses: smithery-ai/flamecast@main
        with:
          prompt: ${{ inputs.prompt }}
          base_branch: ${{ inputs.base_branch }}
          target_repo: ${{ inputs.target_repo }}
          sync_base: ${{ inputs.sync_base }}
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          flamecast_pat: ${{ secrets.FLAMECAST_PAT }}
